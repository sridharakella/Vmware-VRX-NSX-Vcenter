## Connect with Me

- **YouTube**: [Watch and Learn on YouTube](https://www.youtube.com/@AshokKumar-DevOps)  
- **LinkedIn**: [Connect with me on LinkedIn](https://www.linkedin.com/in/ashokkumar-devops13/)  
- **TopMate**: [Support or Consult on TopMate](https://topmate.io/ashok_kumar)  

## Support This Project

If you find this content helpful:
- **Like** the [YouTube video](https://www.youtube.com/@AshokKumar-DevOps) for more such tutorials.
- **Star** this GitHub repository to get the latest updates.

# 4. Maven

### **1. Introduction to Maven**

- **What is Maven?**
    - Maven is an open-source build automation tool primarily for Java projects, but it can manage other languages.
    - It automates the build process, dependency management, project documentation, and reporting.
- **Why Maven in DevOps?**
    - Standardizes the build process across teams.
    - Integrates easily into CI/CD pipelines, facilitating automated builds and testing.
    - Manages dependencies and project versions, ensuring consistency across environments.

### **2. Key Maven Concepts**

1. **POM (Project Object Model)**
    - `pom.xml` is Maven’s configuration file, where project dependencies, plugins, and goals are defined.
    - Each project has a single `pom.xml` file, defining:
        - Project coordinates (groupId, artifactId, version).
        - Dependencies.
        - Plugins and build configurations.
    - **Basic Structure**:
        
        ```xml
        
        <project>
            <modelVersion>4.0.0</modelVersion>
            <groupId>com.example</groupId>
            <artifactId>my-app</artifactId>
            <version>1.0</version>
            <dependencies>
                <!-- Dependency definitions go here -->
            </dependencies>
        </project>
        
        ```
        
2. **Dependency Management**
    - Maven downloads dependencies automatically from repositories.
    - Dependencies are defined in the `dependencies` section of `pom.xml`.
    - **Example**:
        
        ```xml
        
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.13.2</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>com.github.docker-java</groupId>
            <artifactId>docker-java</artifactId>
            <version>3.4.0</version>
        </dependency>
        
        ```
        
3. **Repositories**
    - **Local Repository**: Stored on your local machine (default is `~/.m2/repository`).
    - **Central Repository**: Maven’s default repository on the web (https://repo.maven.apache.org/maven2).
    - **Remote Repository**: Custom repositories defined in `pom.xml` or `settings.xml` (e.g., internal corporate repository).

### **3. Maven Build Lifecycle and Phases**

1. **Build Lifecycle**
    - The default build lifecycle includes three main stages: **clean**, **default** (or build), and **site**.
    - **Key Phases**:
        - `validate`: Validates if all project information is correct.
        - `compile`: Compiles the source code.
        - `test`: Runs unit tests.
        - `package`: Packages compiled code into JAR/WAR files.
        - `verify`: Verifies the integrity of the project and checks for errors.
        - `install`: Installs the package into the local repository.
        - `deploy`: Deploys the project to a remote repository.
2. **Common Commands**
    - `mvn clean`: Cleans the `target` directory by deleting all files generated by previous builds.
    - `mvn compile`: Compiles the source code of the project.
    - `mvn test`: Runs tests using the JUnit testing framework.
    - `mvn package`: Builds the project and packages it into a JAR/WAR file.
    - `mvn install`: Installs the package into the local repository.
    - `mvn deploy`: Deploys the package to the configured remote repository.

### **4. Working with Plugins**

1. **What are Maven Plugins?**
    - Plugins enhance Maven’s capabilities by adding additional goals.
    - Common plugins:
        - **maven-compiler-plugin**: Manages compilation settings.
        - **maven-surefire-plugin**: Manages testing configurations.
        - **maven-jar-plugin**: Configures JAR file creation.
2. **Plugin Example**:
    
    ```xml
    
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.8.1</version>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                </configuration>
            </plugin>
        </plugins>
    </build>
    
    ```
    

### **5. Maven Profiles**

- **Purpose of Profiles**:
    - Maven profiles allow custom build configurations for different environments (e.g., development, testing, production).
- **Profile Example**:
    
    ```xml
    
    <profiles>
        <profile>
            <id>dev</id>
            <properties>
                <environment>development</environment>
            </properties>
        </profile>
        <profile>
            <id>prod</id>
            <properties>
                <environment>production</environment>
            </properties>
        </profile>
    </profiles>
    
    ```
    
- **Command to Activate Profile**:
    
    ```bash
    
    mvn clean install -Pdev
    
    ```
    

### **6. Dependency Scopes**

- Scopes control the classpath for dependencies and when they are available:
    - **compile**: Default scope, available everywhere.
    - **test**: Only for testing; not included in the final package.
    - **provided**: Available at compile and test time but assumed to be provided at runtime by the runtime environment.
    - **runtime**: Available at runtime but not during compilation.

### **7. Using Maven in CI/CD Pipelines**

1. **Jenkins Integration**
    - Jenkins can automate Maven commands within a CI/CD pipeline.
    - Maven is often configured as a build step in Jenkins, executing commands like `mvn clean install`.
2. **Docker with Maven**
    - Maven can be used within Docker for consistent builds across environments.
    - Dockerfile Example:
        
        ```
        
        FROM maven:3.8.4-jdk-11
        WORKDIR /app
        COPY . .
        RUN mvn clean package
        ```
        

### **8. Best Practices for Using Maven in DevOps**

1. **Use a Dependency Management Tool**: Rely on `pom.xml` for dependency management to prevent conflicts.
2. **Consistent Plugin Versions**: Define specific plugin versions to avoid version conflicts.
3. **Use Profiles for Environment Configuration**: Use profiles to configure settings specific to different environments.
4. **Automate Tests and Deployments**: Integrate Maven with CI/CD pipelines to automate builds and tests.

### **9. Troubleshooting Common Maven Issues**

1. **Dependency Conflicts**
    - Check for conflicting versions using `mvn dependency:tree`.
    - Use dependency exclusions if necessary.
2. **Build Failures**
    - Review error messages for the exact cause (e.g., missing dependencies, version conflicts).
    - Use the `X` flag for detailed debugging information.
3. **Repository Access Issues**
    - Verify access to the central or remote repository.
    - Configure proxy settings in `settings.xml` if behind a corporate firewall.

### **10. Commands Reference Table**

| Command | Description |
| --- | --- |
| `mvn clean` | Cleans the project by deleting `target` directory |
| `mvn compile` | Compiles the project source code |
| `mvn test` | Runs tests |
| `mvn package` | Packages the compiled code into JAR/WAR |
| `mvn install` | Installs the package into the local repository |
| `mvn deploy` | Deploys the package to a remote repository |
| `mvn dependency:tree` | Displays the dependency tree |
| `mvn -P<profile>` | Runs Maven with a specific profile |
| `mvn help:effective-pom` | Displays the effective POM with resolved inheritance and profiles |

### [Step 1: Download the JDK Binaries](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#step-1-download-the-jdk-binaries)

```
wget https://download.java.net/java/GA/jdk13.0.1/cec27d702aa74d5a8630c65ae61e4305/9/GPL/openjdk-13.0.1_linux-x64_bin.tar.gz
tar -xvf openjdk-13.0.1_linux-x64_bin.tar.gz
sudo mv jdk-13.0.1 /opt/

```

### [Step 2: Setting JAVA_HOME and Path Environment Variables](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#step-2-setting-java-_home-and-path-environment-variables)

```
JAVA_HOME='/opt/jdk-13.0.1'
PATH="$JAVA_HOME/bin:$PATH"
export PATH

```

You can relaunch the terminal or execute `source .profile` command to apply the configuration changes.

### [Step 3: Verify the Java Installation](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#step-3-verify-the-java-installation)

You can run `java -version` command to verify the JDK installation.

```
$ java -version
openjdk version "13.0.1" 2019-10-15
OpenJDK Runtime Environment (build 13.0.1+9)
OpenJDK 64-Bit Server VM (build 13.0.1+9, mixed mode, sharing)
```

## [Installing Maven on Linux/Ubuntu](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#installing-maven-on-linux-ubuntu)

Go to the URL: https://maven.apache.org/download.cgi Copy the link for the “Binary tar.gz archive” file. Then run the following commands to download and untar it.

### [Step 1: Download the Maven Binaries](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#step-1-download-the-maven-binaries)

```
wget https://dlcdn.apache.org/maven/maven-3/3.9.9/binaries/apache-maven-3.9.9-bin.tar.gz --no-check-certificate
tar -xvf apache-maven-3.9.9-bin.tar.gz
sudo mv apache-maven-3.9.9 /opt/

```

### [Step 2: Setting M2_HOME and Path Variables](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#step-2-setting-m2-_home-and-path-variables)

Add the following lines to the user profile file (.profile).

```
M2_HOME='/opt/apache-maven-3.9.9'
PATH="$M2_HOME/bin:$PATH"
export PATH

```

Relaunch the terminal or execute `source .profile` to apply the changes.

### [Step 3: Verify the Maven installation](https://www.digitalocean.com/community/tutorials/install-maven-linux-ubuntu#step-3-verify-the-maven-installation)

Execute `mvn -version` command and it should produce the following output.

```
$ mvn -version
Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)
Maven home: /opt/apache-maven-3.6.3
Java version: 13.0.1, vendor: Oracle Corporation, runtime: /opt/jdk-13.0.1
Default locale: en, platform encoding: UTF-8
OS name: "linux", version: "4.15.0-47-generic", arch: "amd64", family: "unix"
$
```

To Create a Project:

mvn archetype:generate -DgroupId=com.example -DartifactId=MyApp -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false